{% extends "admin_layout.html" %}
{% block content %}

<!-- Page Title -->
<div class="section-title">Parking Lots</div>

<!-- Parking Lot Cards -->
<div class="d-flex flex-wrap justify-content-start">
    {% if parkinglots %}
    {% for parkinglot in parkinglots %}
    <div class="parking-lot m-3 p-3 border rounded shadow-sm bg-light">
        <div class="lot-title">{{ parkinglot.prime_location_name }}</div>
        <div class="lot-subtitle">{{ parkinglot.address }}</div><br>

        <div class="text-success fw-bold">Available Spots: {{ parkinglot.available_count }}</div>
        <div class="text-danger fw-bold">Occupied Spots: {{ parkinglot.occupied_count }}</div><br>
        <div>
            <a href="{{ url_for('edit_parkinglot', id=parkinglot.id, email=email) }}" class="btn btn-warning">Edit</a>
            <form action="{{ url_for('delete_parkinglot', id=parkinglot.id, email=email) }}" method="POST"
                class="d-inline"
                onsubmit="return confirm('Are you sure you want to delete this parking lot? This action cannot be undone.');">
                <button type="submit" class="btn btn-danger">Delete</button>
            </form>
        </div>
        <hr>
        <!-- Spot Grid -->
        {% if parkinglot.parkingspot %}
        <div class="spot-grid mb-3">
            {% for spot in parkinglot.parkingspot %}
            <a href="{{ url_for('view_spot', spot_id=spot.id, email=user.email ) }}" style="text-decoration: none;">
                <div class="spot-box {% if spot.status == 'A' %}available{% else %}occupied{% endif %}">
                    {{ spot.status }}
                </div>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <p>No spots available in this lot.</p>
        {% endif %}
    </div>
    {% endfor %}
    {% else %}
    <div class="w-100 text-center mt-5">
        <h4 class="text-danger">No parking lots found.</h4>
    </div>
    {% endif %}
</div>
{% if not is_search %} <!--when no_search is false display the code below-->
<!-- Add Lot Button -->
<div class="text-center mt-4">
    <a href="{{ url_for('add_lot', email=email) }}" class="btn btn-primary">Add Lot</a>
</div>
{% endif %}
{% endblock %}